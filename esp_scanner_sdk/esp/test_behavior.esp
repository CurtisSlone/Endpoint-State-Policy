META
  version `1.0.0`
    esp_version `1.0`
    author `test-suite`
    date `2025-10-02`
    severity `high`
    platform `linux`
    description `behavior testing`
    control_framework `CIS`
    control `5.2.1-5.2.6`
    esp_scan_id `behavior_testing`
    criticality `high`
    tags `linux,ssh,security`
META_END

DEF
    VAR test_file_path string `/etc/passwd`

    OBJECT passwd_file
        path VAR test_file_path
        type `file`
        behavior timeout 5
    OBJECT_END

    STATE has_root_user
        content string contains `root`
    STATE_END

    STATE has_shell_users
        content string contains `/bin/bash`
    STATE_END

    CRI AND
        CTN file_content
            TEST all all AND
            STATE_REF has_root_user
            STATE_REF has_shell_users
            OBJECT_REF passwd_file
        CTN_END
    CRI_END
DEF_END
