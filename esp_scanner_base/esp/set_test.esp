META
 version `1.0.0`
    ics_version `1.0`
    author `test-suite`
    date `2025-10-02`
    severity `medium`
    platform `linux`
    description `Handle missing files gracefully`
    control_framework `TEST`
    control `ERROR-1`
    ics_scan_id `set-ops-test`
    criticality `medium`
    tags `linux,error-handling`
META_END

DEF
  VAR passwd_path string `scanfiles/passwd`
  VAR shadow_path string `scanfiles/shadow`
  
  STATE secure_permissions
    permissions string = `0644`
    owner string = `root`
  STATE_END
  
  OBJECT passwd_file
    path VAR passwd_path
  OBJECT_END
  
  OBJECT shadow_file
    path VAR shadow_path
  OBJECT_END
  
  SET critical_files union
    OBJECT_REF passwd_file
    OBJECT_REF shadow_file
  SET_END
  
  CRI AND
    CTN file_metadata
      TEST all all
      STATE_REF secure_permissions
      OBJECT local_obj
        SET_REF critical_files
      OBJECT_END
    CTN_END
  CRI_END
DEF_END